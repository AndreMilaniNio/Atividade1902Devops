name: Arquivo deploy b√°sico

on:
  push:
    branches: [ "master", "development" ]
  pull_request:
    branches: [ "master", "development" ]

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # Clona reposit√≥rio para o github
      - name: Clonar reposit√≥rio
        uses: actions/checkout@v4

      # Verifica se meu index.html existe
      - name: Verificar se index.html existe
        run: |
          if [ ! -f "src/index.html" ]; then
            echo "ERRO: index.html n√£o encontrado em src/pages/"
            exit 1
          else
            echo "index.html encontrado."
          fi

      # Verifica a pasta styles existem
      - name: Verificar se pasta styles existe
        run: |
          if [ ! -d "styles" ]; then
            echo "ERRO: Pasta 'styles' n√£o encontrada."
            exit 1
          else
            echo "Pasta 'styles' encontrada."
          fi

      # Verifica meus arquivos.css
      - name: Verificar arquivos CSS obrigat√≥rios
        run: |
          FILES=("styles/index.css" "styles/sobre.css" "styles/contato.css" "styles/main.css")

          for file in "${FILES[@]}"; do
            if [ ! -f "$file" ]; then
              echo "ERRO: Arquivo CSS obrigat√≥rio n√£o encontrado: $file"
              exit 1
            else
              echo "$file encontrado."
            fi
          done

      # Super-Script de organiza√ß√£o
      - name: Organizar arquivos para deploy
        run: |
          echo "1Ô∏è‚É£ Limpando dist antiga..."
          rm -rf dist

          echo "2Ô∏è‚É£ Criando nova pasta dist..."
          mkdir dist

          echo "3Ô∏è‚É£ Copiando todos os arquivos HTML..."
          find . -name "*.html" -exec cp --parents {} dist/ \;

          echo "4Ô∏è‚É£ Copiando pasta assets..."
          cp -r assets dist/ || true

          echo "5Ô∏è‚É£ Listando conte√∫do da dist..."
          ls -R dist

      # Auditoria de Qualidade
      - name: Auditoria de Qualidade
        run: |
          echo "üîé Verificando arquivos principais dentro da dist..."

          test -f dist/src/index.html || { echo "index.html n√£o encontrado!"; exit 1; }
          test -f dist/src/pages/sobre.html || { echo "sobre.html n√£o encontrado!"; exit 1; }
          test -f dist/src/pages/contato.html || { echo "contato.html n√£o encontrado!"; exit 1; }

          echo "Todos os arquivos principais est√£o presentes!"

      # d√° upload na dist
      - name: Upload artifact para pages
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./dist

      # mensagem de valida√ß√£o
      - name: Projeto validado com sucesso
        run: echo "Estrutura validada! Pronto para deploy."

  # Faz o deploy
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build

    steps:
      - name: Deploy para GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4